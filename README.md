# ğŸ“¡ WebSocket Chatting

## âœ… í”„ë¡œì íŠ¸ ê°œìš”
ì´ë¡ ìœ¼ë¡œë§Œ ì ‘í–ˆë˜ WebSocketì„ ì‹¤ë¬´ì—ì„œ ì‚¬ìš©í•  ê¸°íšŒê°€ ì—†ì–´ì„œ, ìŠ¤ìŠ¤ë¡œ ì‚¬ìš©ë²•ì„ ìµíˆê³  êµ¬í˜„í•œ ê°„ë‹¨í•œ ì±„íŒ… ì„œë¹„ìŠ¤ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.  
WebSocketê³¼ STOMP í”„ë¡œí† ì½œì„ ì ìš©í•˜ì—¬ **ì‹¤ì‹œê°„ ì–‘ë°©í–¥ í†µì‹ **ì„ êµ¬í˜„í•˜ê³ , JWT ì¸ì¦ê³¼ ë³´ì•ˆ ê°•í™”ê¹Œì§€ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.
---

## âœ… ì£¼ìš” ê¸°ëŠ¥

- **íšŒì› ê´€ë¦¬**
  - ë¡œê·¸ì¸ / íšŒì›ê°€ì… (JWT ì¸ì¦ ë°©ì‹, MongoB)
  - ì¤‘ë³µ ë¡œê·¸ì¸ ë°©ì§€
- **ì±„íŒ… ê¸°ëŠ¥**
  - ì±„íŒ…ë°© ìƒì„± / ì¡°íšŒ / ì…ì¥ / í‡´ì¥
  - ì‹¤ì‹œê°„ ì±„íŒ… (WebSocket + STOMP)
  - ì±„íŒ… ë©”ì‹œì§€ ì €ì¥ / ì¡°íšŒ (MongoDB)
- **ë³´ì•ˆ**
  - httpOnly ì¿ í‚¤ì— JWT ì €ì¥ â†’ XSS ë°©ì–´
  - í´ë¼ì´ì–¸íŠ¸ê°€ ì§ì ‘ í† í°ì„ ë‹¤ë£¨ì§€ ì•Šì•„ ë³´ì•ˆ ê°•í™”
  - ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ì‚¬ìš©ìëŠ” ì¿ í‚¤ê°€ ì—†ì–´ ë©”ì¸í˜ì´ì§€ë§Œ ì ‘ê·¼ ê°€ëŠ¥
  - Spring Security ë¡œ ì ‘ê·¼ ì œì–´ ë° ì¸ì¦ ì²˜ë¦¬

---

## âœ… ê¸°ìˆ  ìŠ¤íƒ

| ë¶„ì•¼                              | ì‚¬ìš© ê¸°ìˆ                        |
|---------------------------------|-----------------------------|
| Language(ì–¸ì–´)                    | Java 17                     |
| Framework(í”„ë ˆì„ì›Œí¬)                | Spring Boot 3.2.2           |
| Database(ë°ì´í„°ë² ì´ìŠ¤)                | MongoDB 7.0.17              |
| Server(ì„œë²„)                      | AWS EC2(Ubuntu 24.04.1 LTS) |
| Security(ë³´ì•ˆ)                    | JWT, Spring Security        |
| CI/CD(ë°°í¬)                       | Github Actions              |
| Client(í´ë¼ì´ì–¸íŠ¸)                   | Thymeleaf + Fetch API       |
| Communication Protocol(í†µì‹  í”„ë¡œí† ì½œ) | WebSocket + STOMP           |
--------------------------------------------

## âœ… ì•„í‚¤í…ì²˜ ë° ì£¼ìš” êµ¬í˜„ í¬ì¸íŠ¸

### 1. WebSocket + STOMP êµ¬ì¡°
- STOMP í”„ë¡œí† ì½œì„ ì ìš©í•˜ì—¬ êµ¬ë…/ë°œí–‰ êµ¬ì¡°ë¥¼ ì‚¬ìš©
- ì±„íŒ…ë°© ì…ì¥ ì‹œ ì‹¤ì‹œê°„ ì—°ê²° ìƒì„±, í‡´ì¥ ì‹œ ì—°ê²° ì¢…ë£Œ â†’ **ë¦¬ì†ŒìŠ¤ ìµœì í™”**
- WebSocket í•¸ë“œì‰ì´í¬ì™€ ì¸ì¦ ì ˆì°¨ëŠ” JWTë¡œ ì²˜ë¦¬

### 2. JWT ì¸ì¦ê³¼ ë³´ì•ˆ ê°•í™”
- httpOnly ì¿ í‚¤ì— JWT ì €ì¥í•˜ì—¬ **XSS ë°©ì§€**
- Access Token ë‹¨ë… ì‚¬ìš© â†’ ë§Œë£Œ ì‹œ ì¬ë¡œê·¸ì¸ í•„ìš” (Refresh Token ë¯¸ì‚¬ìš©)
- JWT ë§Œë£Œ ì‹œ ìë™ ë¡œê·¸ì•„ì›ƒ -> ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ì´ë™
- í•„í„°(`JwtAuthenticationFilter`)ë¥¼ í†µí•´ ì¸ì¦ì´ í•„ìš”í•œ ìš”ì²­ ì°¨ë‹¨
- ì¤‘ë³µ ë¡œê·¸ì¸ ê°ì§€ë¥¼ í†µí•´ ë™ì¼ ê³„ì •ì˜ ë‹¤ì¤‘ ì ‘ì† ì œí•œ

### 3. API ì¤‘ì‹¬ ì„¤ê³„
- í˜„ì¬ ë³€ê²½ì—†ì´ ë‹¤ë¥¸ í”„ë¡ íŠ¸ì—”ë“œì™€ ì—°ë™ ê°€ëŠ¥
- Thymeleaf ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ë•Œ Fetch API ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„° ë¡œë“œ

### 4.ë°°í¬
- AWS EC2(Ubuntu) + GitHub Actions ê¸°ë°˜ CI/CD êµ¬ì¶•
- í”„ë¡œí¼í‹° ê°’ì„ GitHub Secretsì— ì €ì¥í•˜ì—¬ ë¯¼ê° ì •ë³´ ë³´í˜¸
- ë°°í¬ ì‹œ secrets ê°’ì„ ì„œë²„ í™˜ê²½ë³€ìˆ˜ë¡œ ì„¤ì • â†’ property íŒŒì¼ì— ë°˜ì˜ í›„ ì‹¤í–‰

## âœ… ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
src
â””â”€â”€ main
    â”œâ”€â”€ java
    â”‚Â Â  â””â”€â”€ com.example.websocket.chatting
    â”‚Â Â      â”œâ”€â”€ Application.java
    â”‚Â Â      â”œâ”€â”€ common
    â”‚Â Â      â”‚Â Â  â”œâ”€â”€ config
    â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ WebSocketConfig.java           # WebSocket ì„¤ì •
    â”‚Â Â      â”‚Â Â  â”œâ”€â”€ exception
    â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ ExceptionController.java       # ê¸€ë¡œë²Œ ì˜ˆì™¸ ì²˜ë¦¬
    â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ ValidationCode.java            # ì»¤ìŠ¤í…€ ìƒíƒœ ì½”ë“œ
    â”‚Â Â      â”‚Â Â  â”œâ”€â”€ security
    â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ EncryptionConfig.java          # íŒ¨ìŠ¤ì›Œë“œ ì•”í˜¸í™”
    â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ JwtAuthenticationFilter.java   # JWT ê²€ì¦ í•„í„°
    â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ JwtProvider.java               # JWT ìƒì„±/ê²€ì¦/ê´€ë¦¬
    â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ SecurityConfig.java            # Spring Security ì„¤ì •
    â”‚Â Â      â”‚Â Â  â””â”€â”€ util
    â”‚Â Â      â”‚Â Â      â””â”€â”€ CommonUtil.java
    â”‚Â Â      â”œâ”€â”€ controller
    â”‚Â Â      â”‚Â Â  â”œâ”€â”€ ChatServiceController.java         # ì±„íŒ… REST API
    â”‚Â Â      â”‚Â Â  â””â”€â”€ ChatViewController.java            # ë·° ì²˜ë¦¬ìš© Controller
    â”‚Â Â      â”œâ”€â”€ dto
    â”‚Â Â      â”‚Â Â  â””â”€â”€ ChatServiceRequestDto.java
    â”‚Â Â      â”œâ”€â”€ model
    â”‚Â Â      â”‚Â Â  â”œâ”€â”€ ChatMessage.java
    â”‚Â Â      â”‚Â Â  â”œâ”€â”€ ChatRoom.java
    â”‚Â Â      â”‚Â Â  â””â”€â”€ Member.java
    â”‚Â Â      â”œâ”€â”€ repository
    â”‚Â Â      â”‚Â Â  â””â”€â”€ MemberRepository.java
    â”‚Â Â      â””â”€â”€ service
    â”‚Â Â          â”œâ”€â”€ ChatService.java
    â”‚Â Â          â””â”€â”€ impl
    â”‚Â Â              â””â”€â”€ ChatServiceImpl.java
    â””â”€â”€ resources
        â”œâ”€â”€ application.yml
        â”œâ”€â”€ static/css
        â”‚Â Â  â”œâ”€â”€ chat.css
        â”‚Â Â  â”œâ”€â”€ index.css
        â”‚Â Â  â”œâ”€â”€ login.css
        â”‚Â Â  â””â”€â”€ register.css
        â””â”€â”€ templates
            â”œâ”€â”€ chat.html
            â”œâ”€â”€ error.html
            â”œâ”€â”€ index.html
            â”œâ”€â”€ login.html
            â””â”€â”€ register.html
```